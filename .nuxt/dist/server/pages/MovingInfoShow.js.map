{"version":3,"file":"pages/MovingInfoShow.js","sources":["webpack:///./pages/MovingInfoShow.vue","webpack:///./pages/MovingInfoShow.vue?8b6b","webpack:///./pages/MovingInfoShow.vue?7d88","webpack:///./pages/MovingInfoShow.vue?99c6","webpack:///./pages/MovingInfoShow.vue?4780","webpack:///./pages/MovingInfoShow.vue?6d6b","webpack:///./pages/MovingInfoShow.vue?1988"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n    components: {},\n    data() {\n        return {\n            dataText: '',\n            timer: 0,\n            timers: null,\n            localIp: '172.17.35.23:24699',\n            tableData: [],\n            tableLoading: true,\n        }\n    },\n    watch: {\n        timer(n, o) {\n            if (n == 0 || o == 0) {\n                clearInterval(this.timers)\n            }\n            if (n > 0 && n < 1000) {\n                this.timer = 1000\n            }\n            if (o == 0 && n > 0) {\n                clearInterval(this.timers)\n                this.getDeviceList()\n                // this.getData()\n            }\n        }\n    },\n    computed: {},\n    methods: {\n        // deviceIndValueEmpty(indicatorCurr, i, c) {\n        //     let Obj = {}\n        //     Obj.indicatorName = indicatorCurr.name;\n        //     Obj.indicatorValue = '';\n        //     Obj.unit = indicatorCurr.unit || ''\n        //     Obj.id = i + c\n        //     $scope.moduleList[indicatorCurr.id] = Obj\n        // },\n        //获取设备\n        flitterData(arr) {\n            let spanOneArr = []\n            let spanTwoArr = []\n            let concatOne = 0\n            let concatTwo = 0\n            arr.forEach((item, index) => {\n                if (index === 0) {\n                    spanOneArr.push(1);\n                    spanTwoArr.push(1);\n                } else {\n                    if (item.deviceName === arr[index - 1].deviceName) { //第一列需合并相同内容的判断条件\n                        spanOneArr[concatOne] += 1;\n                        spanOneArr.push(0);\n                    } else {\n                        spanOneArr.push(1);\n                        concatOne = index;\n                    };\n                    if (item.code === arr[index - 1].code && item.deviceName === arr[index - 1].deviceName) { //第二列需合并相同内容的判断条件\n                        spanTwoArr[concatTwo] += 1;\n                        spanTwoArr.push(0);\n                    } else {\n                        spanTwoArr.push(1);\n                        concatTwo = index;\n                    };\n                }\n            });\n            return {\n                one: spanOneArr,\n                two: spanTwoArr,\n            }\n        },\n        // 合并列\n        objectSpanMethods({ row, column, rowIndex, columnIndex }) {\n            if (columnIndex === 0) {\n                const _row = (this.flitterData(this.tableData).one)[rowIndex];\n                const _col = _row > 0 ? 1 : 0;\n                return {\n                    rowspan: _row,\n                    colspan: _col\n                };\n            }\n            // if (columnIndex === 1) {\n            //     const _row = (this.flitterData(this.tableData).two)[rowIndex];\n            //     const _col = _row > 0 ? 1 : 0;\n            //     return {\n            //         rowspan: _row,\n            //         colspan: _col\n            //     };\n            // }\n        },\n        //赋值空数据方法\n        setIndicatorValueEmpty(deviceList, indicators, i, c) {\n            let ObjEmpty = {}\n            ObjEmpty.deviceName = deviceList[i].name\n            ObjEmpty.id = c\n            ObjEmpty.indicatorName = indicators[c].name || ''\n            ObjEmpty.indicatorValue = indicators[c].value || ''\n            ObjEmpty.indicatorUnit = indicators[c].unit || ''\n            return ObjEmpty\n        },\n        //获取设备信息\n        getDeviceInfo() {\n            return new Promise((res, rej) => {\n                $.ajax({\n                    type: \"POST\",\n                    url: 'http://' + this.localIp + '/testData/getPowerDeviceMsg',\n                    success: (deviceData) => {\n                        res(deviceData.data)\n                    },\n                    error: (err) => {\n                        rej('设备获取失败'+'/testData/getPowerDeviceMsg')\n                    }\n                })\n            }).catch(e=>{\n                return e\n            })\n        },\n        //获取指标\n        getDeviceIndocator() {\n            return new Promise((res, rej) => {\n                $.ajax({\n                    type: 'POST',\n                    url: 'http://' + this.localIp + '/testData/getPeDeviceIndicator',\n                    success: (indicatorName) => {\n                        res(indicatorName.data)\n                    },\n                    error: () => {\n                        rej('设备指标获取失败'+'/testData/getPeDeviceIndicator')\n                    }\n                })\n            }).catch(e=>{\n                return e\n            })\n        },\n        // 获取指标值\n        getIndicatorData(deviceId) {\n            return new Promise((res, rej) => {\n                $.ajax({\n                    type: 'POST',\n                    url: 'http://' + this.localIp + '/testData/getPeDeviceIndicatorData',\n                    // url: 'http://' + self.localIp + '/testData/getPeDeviceIndicator',\n                    data: { deviceId, },\n                    success: (data) => {\n                        res(data.data && (data.data.indicators.length ? data.data.indicators : []))\n                    },\n                    error: () => {\n                        rej('指标值获取失败'+'/testData/getPeDeviceIndicatorData')\n                    }\n                })\n            }).catch(e=>{\n                return e\n            })\n        },\n        async getDeviceList() {\n            !this.timer&&(this.tableLoading = true)\n            this.timers && clearInterval(this.timers)\n            let tableList = []\n            // this.tableData = []\n            let self = this\n            //设备信息\n            let deviceList = await this.getDeviceInfo()\n            if (typeof deviceList == 'string') {\n                this.$message({ type: \"error\", message: deviceList, duration: 3000 })\n                this.tableLoading = false\n                return\n            }\n            let indicators = await this.getDeviceIndocator()\n            if (typeof indicators == 'string') {\n                this.$message({ type: \"error\", message: indicators, duration: 3000 })\n                this.tableLoading = false\n                return\n            }\n            for (let i in deviceList) {\n                var Obj = []\n                let datas = await this.getIndicatorData(deviceList[i].id)\n                if (typeof datas == 'string') {\n                    this.$message({ type: \"error\", message: datas, duration: 3000 })\n                    this.tableLoading = false\n                    return\n                } else {\n                    for (let a in datas) {\n                        for (let c in indicators) {\n                            if (indicators[c].id == datas[a].key) {\n                                let ObjChildren = {}\n                                let itemValueMap = indicators[c].indicatorValueMap\n                                ObjChildren.deviceName = deviceList[i].name\n                                ObjChildren.id = c\n                                ObjChildren.indicatorName = indicators[c].name\n                                ObjChildren.indicatorValue = itemValueMap != null ? JSON.parse(JSON.stringify(itemValueMap))[parseInt(datas[a].value)] : datas[a].value\n                                ObjChildren.originValue = datas[a].value\n                                ObjChildren.isValueMap = Boolean(itemValueMap != null)\n                                ObjChildren.indicatorUnit = indicators[c].unit || ''\n                                tableList.push(ObjChildren)\n                            }\n                        }\n                    }\n                }\n            }\n            tableList.sort((a, b) => {\n                return a.id - b.id\n            })\n            this.tableData = tableList\n            this.tableLoading = false\n\n            if (this.timer == 0) { return }\n            this.timers = setInterval(() => {\n                self.getDeviceList()\n            }, self.timer)\n\n        },\n        getDeviceIndicator() {\n\n        },\n        getData() {\n            this.timers && clearInterval(this.timers)\n            $.ajax({\n                type: \"POST\",\n                async: false,\n                url: 'http://' + this.localIp + '/testData/getPowerDeviceMsg',\n                success: data => {\n                    data = data.data\n\n                    let tempList = []\n                    for (let i in data) {\n                        let obj = {}\n                        obj.deviceName = data[i].name\n                        obj.indicatorName = data[i].name + 1\n                        obj.indicatorValue = data[i].id\n                        obj.id = data[i].id + 2\n                        tempList.push(obj)\n                    }\n                    this.tableData = tempList\n                    this.showData = data[0]\n                    // this.timer = 1200\n\n                },\n            })\n            // this.tableData = []\n        }\n    },\n    mounted() {\n        this.getDeviceList()\n        // this.getData()\n    },\n    created() {\n\n    },\n    destroyed(){\n        this.timers && clearInterval(this.timers)\n    }\n}\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MovingInfoShow.vue?vue&type=style&index=0&id=19b64e1e&lang=less&scoped=true&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"3cd63508\", content, true, context)\n};","import mod from \"-!../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MovingInfoShow.vue?vue&type=style&index=0&id=19b64e1e&lang=less&scoped=true&\"; export default mod; export * from \"-!../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MovingInfoShow.vue?vue&type=style&index=0&id=19b64e1e&lang=less&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".red_round[data-v-19b64e1e]{background-color:red}.green_round[data-v-19b64e1e],.red_round[data-v-19b64e1e]{transform:translateY(19%);display:inline-block;width:1rem;height:1rem;border-radius:50%}.green_round[data-v-19b64e1e]{background-color:green}.content[data-v-19b64e1e]{width:60%;margin:2% auto 0}.el_table[data-v-19b64e1e]{width:100%;position:relative}.content_title[data-v-19b64e1e]{text-align:right;margin:0 10% 1% 0}[data-v-19b64e1e] .el-message{top:50px!important}input[data-v-19b64e1e]{height:20rem}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_vm._ssrNode(\"<title data-v-19b64e1e></title> \"),_vm._ssrNode(\"<div class=\\\"content_title\\\" data-v-19b64e1e>\",\"</div>\",[_vm._ssrNode(\"\\n        定时刷新时间(MS),0为不刷新：\"),_c('el-input',{staticStyle:{\"display\":\"inline-block\",\"width\":\"10%\",\"margin-right\":\"5%\"},attrs:{\"size\":\"small\"},model:{value:(_vm.timer),callback:function ($$v) {_vm.timer=$$v},expression:\"timer\"}}),_vm._ssrNode(\" \"),_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"success\"},on:{\"click\":_vm.getDeviceList}},[_vm._v(\"刷新\")])],2),_vm._ssrNode(\" \"),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.tableLoading),expression:\"tableLoading\"}],ref:\"myTable\",staticStyle:{\"width\":\"100%\",\"margin-bottom\":\"20px\"},attrs:{\"data\":_vm.tableData,\"span-method\":_vm.objectSpanMethods,\"row-key\":\"id\",\"border\":\"\",\"default-expand-all\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"deviceName\",\"label\":\"设备\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"indicatorName\",\"label\":\"指标名称\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"indicatorValue\",\"label\":\"指标值\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.isValueMap&&scope.row.originValue==1)?_c('i',{staticClass:\"red_round\"}):_vm._e(),_vm._v(\" \"),(scope.row.isValueMap&&scope.row.originValue==0)?_c('i',{staticClass:\"green_round\"}):_vm._e(),_vm._v(\"\\n                \"+_vm._s(scope.row.indicatorValue)+_vm._s(scope.row.indicatorUnit)+\"\\n            \")]}}])})],1)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MovingInfoShow.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MovingInfoShow.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MovingInfoShow.vue?vue&type=template&id=19b64e1e&scoped=true&\"\nimport script from \"./MovingInfoShow.vue?vue&type=script&lang=js&\"\nexport * from \"./MovingInfoShow.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./MovingInfoShow.vue?vue&type=style&index=0&id=19b64e1e&lang=less&scoped=true&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"19b64e1e\",\n  \"7fed7e1e\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AAdA;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAUA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAUA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;AAYA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;AApBA;AAuBA;AACA;AAjNA;AACA;AAiNA;AACA;AAEA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAxPA;;;;;;;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACVA;AAAA;AAAA;AAAA;AAAA;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AACA;AACA;;;;;;;;ACFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}