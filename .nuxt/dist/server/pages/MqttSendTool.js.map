{"version":3,"file":"pages/MqttSendTool.js","sources":["webpack:///./pages/MqttSendTool.vue","webpack:///./pages/MqttSendTool.vue?ef8a","webpack:///./pages/MqttSendTool.vue?7b35","webpack:///./pages/MqttSendTool.vue?5d33","webpack:///./pages/MqttSendTool.vue?becc","webpack:///./pages/MqttSendTool.vue?8c12","webpack:///./pages/MqttSendTool.vue?b320"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n    components: {},\n    data() {\n        return {\n            dialogVisible: false,\n            //本地IP\n            localIP: '',\n            //表格框加载\n            tableLoading: false,\n            tableData: [],\n            editTable: '',\n            editId: '',\n            editswitchStatus: ''\n\n        }\n    },\n    watch: {},\n    computed: {\n\n    },\n    methods: {\n        //设置本地储存方法\n        local(key, value) {\n            return value ? localStorage.setItem(key, value) : localStorage.getItem(key)\n        },\n        saveEdit() {\n            this.tableLoading = true\n            this.dialogVisible = false\n            let indicatorValue = this.editTable\n            //保存\n            let deviceId = this.editId\n            let switchStatus = this.editswitchStatus\n            let parmas = { indicatorValue, deviceId, switchStatus }\n            $.ajax({\n                type: 'POST',\n                url: 'http://' + this.localIP + '/testData/setIndicatorValue',\n                data: parmas,\n                success: (data) => {\n                    this.tableLoading = false\n                    data.success && this.$message({ type: 'success', message: '数据修改成功！', duration: 1000, offset: 100 })\n                },\n                error: () => {\n                    this.tableLoading = false\n                    this.$message({ type: 'error', message: '数据获取失败，请检查IP地址！', duration: 3000, offset: 100 })\n                }\n            })\n        },\n        changeData(value) {\n            this.dialogVisible = true\n            if (!value.switchStatus) {\n                //等于一\n                this.editTable = this.getFormatData(JSON.stringify(value.masterData))\n            } else {\n                this.editTable = this.getFormatData(JSON.stringify(value.slaveData))\n            }\n            this.editId = value.id\n            this.editswitchStatus = value.switchStatus\n        },\n        //获取所有数据\n        getAllMqttData() {\n            this.tableLoading = true\n            $.ajax({\n                type: 'POST',\n                url: 'http://' + this.localIP + '/testData/getDeviceListData',\n                success: (data) => {\n                    this.tableLoading = false\n                    if (data.data == []) {\n                        this.$message({ type: 'error', message: '获取数据为空！请确认数据是否存在', duration: 3000, offset: 100 })\n                        return\n                    }\n                    this.tableData = data.data\n                    data.success && this.$message({ type: 'success', message: '数据获取成功！', duration: 1000, offset: 100 })\n                },\n                error: () => {\n                    this.tableLoading = false\n                    this.$message({ type: 'error', message: '数据获取失败，请检查IP地址！', duration: 3000, offset: 100 })\n                }\n            })\n        },\n        //数据处理\n        dataProcessing() {\n\n        },\n        //批量设置\n        /**\n         * @type 0 主 1 备 \n         * @Date 2020-08-26 14:13:24\n         */\n        batch(type) {\n            this.tableData.forEach(item => {\n                item.switchStatus = type ? 1 : 0\n            })\n            this.sendData()\n        },\n        //发送数据\n        sendData(value) {\n            this.tableLoading = true\n            let data = value ? value : this.tableData\n            let params = {\n                deviceIds: ''\n            }\n            if (data.length > 1) {\n                data.map(item => {\n                    params.deviceIds += item.id + ','\n                })\n                params.deviceIds = params.deviceIds.substr(0, params.deviceIds.length - 1)\n                params.switchStatus = data[0].switchStatus\n            } else {\n                params.deviceIds = data.id\n                params.switchStatus = data.switchStatus\n            }\n            // return\n            $.ajax({\n                type: \"POST\",\n                url: 'http://' + this.localIP + '/testData/applySwitch',\n                data: params,\n                success: (data) => {\n                    data.success && this.$message({ type: 'success', message: '数据发送成功！', duration: 1000, offset: 100 })\n                    this.tableLoading = false\n                },\n                error: (err) => {\n                    this.$message({ type: 'error', message: err.msg || '数据发送错误！', duration: 1000, offset: 100 })\n                    this.tableLoading = false\n                }\n            })\n            // this.getAllMqttData()\n        },\n        //读取本地localIP\n        getLocalIP() {\n            this.localIP = '172.17.35.23:24699'\n            // local('localIP') == null && local('localIP', '172.17.35.23:24699')\n        },\n\n        //方法\n        repeat(s, count) {\n            return new Array(count + 1).join(s)\n        },\n        //String 转为 JSON格式\n        formatJson(json) {\n            var i = 0,\n                il = 0,\n                tab = \"    \",\n                newJson = \"\",\n                indentLevel = 0,\n                inString = false,\n                currentChar = null;\n            for (i = 0, il = json.length; i < il; i += 1) {\n                currentChar = json.charAt(i);\n                switch (currentChar) {\n                    case '{':\n                    case '[':\n                        if (!inString) {\n                            newJson += currentChar + \"\\n\" + this.repeat(tab, indentLevel + 1);\n                            indentLevel += 1\n                        } else {\n                            newJson += currentChar\n                        }\n                        break;\n                    case '}':\n                    case ']':\n                        if (!inString) {\n                            indentLevel -= 1;\n                            newJson += \"\\n\" + this.repeat(tab, indentLevel) + currentChar\n                        } else {\n                            newJson += currentChar\n                        }\n                        break;\n                    case ',':\n                        if (!inString) {\n                            newJson += \",\\n\" + this.repeat(tab, indentLevel)\n                        } else {\n                            newJson += currentChar\n                        }\n                        break;\n                    case ':':\n                        if (!inString) {\n                            newJson += \": \"\n                        } else {\n                            newJson += currentChar\n                        }\n                        break;\n                    case ' ':\n                    case \"\\n\":\n                    case \"\\t\":\n                        if (inString) {\n                            newJson += currentChar\n                        }\n                        break;\n                    case '\"':\n                        if (i > 0 && json.charAt(i - 1) !== '\\\\') {\n                            inString = !inString\n                        }\n                        newJson += currentChar;\n                        break;\n                    default:\n                        newJson += currentChar;\n                        break\n                }\n            }\n            return newJson\n        },\n        getFormatData(json) {\n            var json = json + \"\";\n            if (json.indexOf('{') == -1 && json.indexOf('[') == -1) {\n                return json;\n            } else {\n                return (this.formatJson(json));\n            }\n        }\n\n    },\n    mounted() {\n        //读取本地IP\n        this.getLocalIP()\n        this.getAllMqttData()\n\n    },\n    created() {\n\n    },\n}\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MqttSendTool.vue?vue&type=style&index=0&id=71053f6e&lang=less&scoped=true&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"42b3f5bc\", content, true, context)\n};","import mod from \"-!../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MqttSendTool.vue?vue&type=style&index=0&id=71053f6e&lang=less&scoped=true&\"; export default mod; export * from \"-!../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MqttSendTool.vue?vue&type=style&index=0&id=71053f6e&lang=less&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".content[data-v-71053f6e]{width:60%;margin:2% auto 0}.el_table[data-v-71053f6e]{width:100%;position:relative}.content_title[data-v-71053f6e]{text-align:right;margin-right:10%}[data-v-71053f6e] .el-message{top:50px!important}input[data-v-71053f6e]{height:20rem}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_vm._ssrNode(\"<title data-v-71053f6e></title> \"),_vm._ssrNode(\"<div class=\\\"content_title\\\" data-v-71053f6e>\",\"</div>\",[_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"small\"},on:{\"click\":_vm.getAllMqttData}},[_vm._v(\"获取\")]),_vm._ssrNode(\" \"),_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){return _vm.batch(0)}}},[_vm._v(\"批量主发送\")]),_vm._ssrNode(\" \"),_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){return _vm.batch(1)}}},[_vm._v(\"批量备发送\")])],2),_vm._ssrNode(\" \"),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.tableLoading),expression:\"tableLoading\"}],staticClass:\"el_table\",attrs:{\"data\":_vm.tableData}},[_vm._v(\"\\n        >\\n        \"),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"名称\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"切换源\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-radio-group',{model:{value:(scope.row.switchStatus),callback:function ($$v) {_vm.$set(scope.row, \"switchStatus\", $$v)},expression:\"scope.row.switchStatus\"}},[_c('el-radio',{attrs:{\"label\":0},on:{\"click\":function($event){scope.row.switchStatus = 0}}},[_vm._v(\"主\")]),_vm._v(\" \"),_c('el-radio',{attrs:{\"label\":1},on:{\"click\":function($event){scope.row.switchStatus = 1}}},[_vm._v(\"备\")])],1)]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.changeData(scope.row)}}},[_vm._v(\"编辑\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.sendData(scope.row)}}},[_vm._v(\"发送\")])]}}])})],1),_vm._ssrNode(\" \"),_c('el-dialog',{attrs:{\"title\":\"编辑\",\"visible\":_vm.dialogVisible,\"width\":\"30%\",\"close-on-click-modal\":false},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-input',{staticClass:\"el_input\",attrs:{\"type\":\"textarea\",\"rows\":25},model:{value:(_vm.editTable),callback:function ($$v) {_vm.editTable=$$v},expression:\"editTable\"}}),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.saveEdit}},[_vm._v(\"确 定\")])],1)],1)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MqttSendTool.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./MqttSendTool.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MqttSendTool.vue?vue&type=template&id=71053f6e&scoped=true&\"\nimport script from \"./MqttSendTool.vue?vue&type=script&lang=js&\"\nexport * from \"./MqttSendTool.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./MqttSendTool.vue?vue&type=style&index=0&id=71053f6e&lang=less&scoped=true&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"71053f6e\",\n  \"3bd96cbc\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAYA;AACA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAXA;AAaA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAfA;AAiBA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAAA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAXA;AAcA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAMA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAhDA;AAkDA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AA7LA;AACA;AA8LA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AA1NA;;;;;;;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACVA;AAAA;AAAA;AAAA;AAAA;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AACA;AACA;;;;;;;;ACFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}