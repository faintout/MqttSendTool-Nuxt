(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{280:function(e,t,n){"use strict";(function(e){n(41),n(40);var r=n(3);n(16),n(42);t.a={components:{},data:function(){return{dataText:"",timer:0,timers:null,localIp:"172.17.35.23:24699",tableData:[],tableLoading:!0}},watch:{timer:function(e,t){0!=e&&0!=t||clearInterval(this.timers),e>0&&e<1e3&&(this.timer=1e3),0==t&&e>0&&(clearInterval(this.timers),this.getDeviceList())}},computed:{},methods:{flitterData:function(e){var t=[],n=[],r=0,o=0;return e.forEach((function(c,l){0===l?(t.push(1),n.push(1)):(c.deviceName===e[l-1].deviceName?(t[r]+=1,t.push(0)):(t.push(1),r=l),c.code===e[l-1].code&&c.deviceName===e[l-1].deviceName?(n[o]+=1,n.push(0)):(n.push(1),o=l))})),{one:t,two:n}},objectSpanMethods:function(e){e.row,e.column;var t=e.rowIndex;if(0===e.columnIndex){var n=this.flitterData(this.tableData).one[t];return{rowspan:n,colspan:n>0?1:0}}},setIndicatorValueEmpty:function(e,t,i,n){var r={};return r.deviceName=e[i].name,r.id=n,r.indicatorName=t[n].name||"",r.indicatorValue=t[n].value||"",r.indicatorUnit=t[n].unit||"",r},getDeviceInfo:function(){var t=this;return new Promise((function(n,r){e.ajax({type:"POST",url:"http://"+t.localIp+"/testData/getPowerDeviceMsg",success:function(e){n(e.data)},error:function(e){r("设备获取失败/testData/getPowerDeviceMsg")}})})).catch((function(e){return e}))},getDeviceIndocator:function(){var t=this;return new Promise((function(n,r){e.ajax({type:"POST",url:"http://"+t.localIp+"/testData/getPeDeviceIndicator",success:function(e){n(e.data)},error:function(){r("设备指标获取失败/testData/getPeDeviceIndicator")}})})).catch((function(e){return e}))},getIndicatorData:function(t){var n=this;return new Promise((function(r,o){e.ajax({type:"POST",url:"http://"+n.localIp+"/testData/getPeDeviceIndicatorData",data:{deviceId:t},success:function(data){r(data.data&&(data.data.indicators.length?data.data.indicators:[]))},error:function(){o("指标值获取失败/testData/getPeDeviceIndicatorData")}})})).catch((function(e){return e}))},getDeviceList:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,c,i,l,a,d,v,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!e.timer&&(e.tableLoading=!0),e.timers&&clearInterval(e.timers),n=[],r=e,t.next=6,e.getDeviceInfo();case 6:if("string"!=typeof(o=t.sent)){t.next=11;break}return e.$message({type:"error",message:o,duration:3e3}),e.tableLoading=!1,t.abrupt("return");case 11:return t.next=13,e.getDeviceIndocator();case 13:if("string"!=typeof(c=t.sent)){t.next=18;break}return e.$message({type:"error",message:c,duration:3e3}),e.tableLoading=!1,t.abrupt("return");case 18:t.t0=regeneratorRuntime.keys(o);case 19:if((t.t1=t.t0()).done){t.next=34;break}return i=t.t1.value,[],t.next=24,e.getIndicatorData(o[i].id);case 24:if("string"!=typeof(l=t.sent)){t.next=31;break}return e.$message({type:"error",message:l,duration:3e3}),e.tableLoading=!1,t.abrupt("return");case 31:for(a in l)for(d in c)c[d].id==l[a].key&&(v={},m=c[d].indicatorValueMap,v.deviceName=o[i].name,v.id=d,v.indicatorName=c[d].name,v.indicatorValue=null!=m?JSON.parse(JSON.stringify(m))[parseInt(l[a].value)]:l[a].value,v.originValue=l[a].value,v.isValueMap=Boolean(null!=m),v.indicatorUnit=c[d].unit||"",n.push(v));case 32:t.next=19;break;case 34:if(n.sort((function(a,b){return a.id-b.id})),e.tableData=n,e.tableLoading=!1,0!=e.timer){t.next=39;break}return t.abrupt("return");case 39:e.timers=setInterval((function(){r.getDeviceList()}),r.timer);case 40:case"end":return t.stop()}}),t)})))()},getDeviceIndicator:function(){},getData:function(){var t=this;this.timers&&clearInterval(this.timers),e.ajax({type:"POST",async:!1,url:"http://"+this.localIp+"/testData/getPowerDeviceMsg",success:function(data){data=data.data;var e=[];for(var i in data){var n={};n.deviceName=data[i].name,n.indicatorName=data[i].name+1,n.indicatorValue=data[i].id,n.id=data[i].id+2,e.push(n)}t.tableData=e,t.showData=data[0]}})}},mounted:function(){this.getDeviceList()},created:function(){},destroyed:function(){this.timers&&clearInterval(this.timers)}}}).call(this,n(284))},281:function(e,t,n){var content=n(286);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(85).default)("3cd63508",content,!0,{sourceMap:!1})},285:function(e,t,n){"use strict";var r=n(281);n.n(r).a},286:function(e,t,n){(t=n(84)(!1)).push([e.i,".red_round[data-v-19b64e1e]{background-color:red}.green_round[data-v-19b64e1e],.red_round[data-v-19b64e1e]{transform:translateY(19%);display:inline-block;width:1rem;height:1rem;border-radius:50%}.green_round[data-v-19b64e1e]{background-color:green}.content[data-v-19b64e1e]{width:60%;margin:2% auto 0}.el_table[data-v-19b64e1e]{width:100%;position:relative}.content_title[data-v-19b64e1e]{text-align:right;margin:0 10% 1% 0}[data-v-19b64e1e] .el-message{top:50px!important}input[data-v-19b64e1e]{height:20rem}",""]),e.exports=t},291:function(e,t,n){"use strict";n.r(t);var r=n(280).a,o=(n(285),n(27)),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[n("title"),e._v(" "),n("div",{staticClass:"content_title"},[e._v("\n        定时刷新时间(MS),0为不刷新："),n("el-input",{staticStyle:{display:"inline-block",width:"10%","margin-right":"5%"},attrs:{size:"small"},model:{value:e.timer,callback:function(t){e.timer=t},expression:"timer"}}),e._v(" "),n("el-button",{attrs:{size:"mini",type:"success"},on:{click:e.getDeviceList}},[e._v("刷新")])],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"myTable",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.tableData,"span-method":e.objectSpanMethods,"row-key":"id",border:"","default-expand-all":""}},[n("el-table-column",{attrs:{prop:"deviceName",label:"设备",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"indicatorName",label:"指标名称",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"indicatorValue",label:"指标值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isValueMap&&1==t.row.originValue?n("i",{staticClass:"red_round"}):e._e(),e._v(" "),t.row.isValueMap&&0==t.row.originValue?n("i",{staticClass:"green_round"}):e._e(),e._v("\n                "+e._s(t.row.indicatorValue)+e._s(t.row.indicatorUnit)+"\n            ")]}}])})],1)],1)}),[],!1,null,"19b64e1e",null);t.default=component.exports}}]);