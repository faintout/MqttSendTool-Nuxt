(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{282:function(t,e,n){"use strict";(function(t){n(170);e.a={components:{},data:function(){return{dialogVisible:!1,localIP:"",tableLoading:!1,tableData:[],editTable:"",editId:"",editswitchStatus:""}},watch:{},computed:{},methods:{local:function(t,e){return e?localStorage.setItem(t,e):localStorage.getItem(t)},saveEdit:function(){var e=this;this.tableLoading=!0,this.dialogVisible=!1;var n={indicatorValue:this.editTable,deviceId:this.editId,switchStatus:this.editswitchStatus};t.ajax({type:"POST",url:"http://"+this.localIP+"/testData/setIndicatorValue",data:n,success:function(data){e.tableLoading=!1,data.success&&e.$message({type:"success",message:"数据修改成功！",duration:1e3,offset:100})},error:function(){e.tableLoading=!1,e.$message({type:"error",message:"数据获取失败，请检查IP地址！",duration:3e3,offset:100})}})},changeData:function(t){this.dialogVisible=!0,t.switchStatus?this.editTable=this.getFormatData(JSON.stringify(t.slaveData)):this.editTable=this.getFormatData(JSON.stringify(t.masterData)),this.editId=t.id,this.editswitchStatus=t.switchStatus},getAllMqttData:function(){var e=this;this.tableLoading=!0,t.ajax({type:"POST",url:"http://"+this.localIP+"/testData/getDeviceListData",success:function(data){e.tableLoading=!1,data.data!=[]?(e.tableData=data.data,data.success&&e.$message({type:"success",message:"数据获取成功！",duration:1e3,offset:100})):e.$message({type:"error",message:"获取数据为空！请确认数据是否存在",duration:3e3,offset:100})},error:function(){e.tableLoading=!1,e.$message({type:"error",message:"数据获取失败，请检查IP地址！",duration:3e3,offset:100})}})},dataProcessing:function(){},batch:function(t){this.tableData.forEach((function(e){e.switchStatus=t?1:0})),this.sendData()},sendData:function(e){var n=this;this.tableLoading=!0;var data=e||this.tableData,o={deviceIds:""};data.length>1?(data.map((function(t){o.deviceIds+=t.id+","})),o.deviceIds=o.deviceIds.substr(0,o.deviceIds.length-1),o.switchStatus=data[0].switchStatus):(o.deviceIds=data.id,o.switchStatus=data.switchStatus),t.ajax({type:"POST",url:"http://"+this.localIP+"/testData/applySwitch",data:o,success:function(data){data.success&&n.$message({type:"success",message:"数据发送成功！",duration:1e3,offset:100}),n.tableLoading=!1},error:function(t){n.$message({type:"error",message:t.msg||"数据发送错误！",duration:1e3,offset:100}),n.tableLoading=!1}})},getLocalIP:function(){this.localIP="172.17.35.23:24699"},repeat:function(s,t){return new Array(t+1).join(s)},formatJson:function(t){var e,i=0,n="",o=0,c=!1,l=null;for(i=0,e=t.length;i<e;i+=1)switch(l=t.charAt(i)){case"{":case"[":c?n+=l:(n+=l+"\n"+this.repeat("    ",o+1),o+=1);break;case"}":case"]":c?n+=l:(o-=1,n+="\n"+this.repeat("    ",o)+l);break;case",":n+=c?l:",\n"+this.repeat("    ",o);break;case":":n+=c?l:": ";break;case" ":case"\n":case"\t":c&&(n+=l);break;case'"':i>0&&"\\"!==t.charAt(i-1)&&(c=!c),n+=l;break;default:n+=l}return n},getFormatData:function(t){return-1==(t=t+"").indexOf("{")&&-1==t.indexOf("[")?t:this.formatJson(t)}},mounted:function(){this.getLocalIP(),this.getAllMqttData()},created:function(){}}}).call(this,n(284))},283:function(t,e,n){var content=n(288);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(85).default)("42b3f5bc",content,!0,{sourceMap:!1})},287:function(t,e,n){"use strict";var o=n(283);n.n(o).a},288:function(t,e,n){(e=n(84)(!1)).push([t.i,".content[data-v-71053f6e]{width:60%;margin:2% auto 0}.el_table[data-v-71053f6e]{width:100%;position:relative}.content_title[data-v-71053f6e]{text-align:right;margin-right:10%}[data-v-71053f6e] .el-message{top:50px!important}input[data-v-71053f6e]{height:20rem}",""]),t.exports=e},290:function(t,e,n){"use strict";n.r(e);var o=n(282).a,c=(n(287),n(27)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[n("title"),t._v(" "),n("div",{staticClass:"content_title"},[n("el-button",{attrs:{type:"success",size:"small"},on:{click:t.getAllMqttData}},[t._v("获取")]),t._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.batch(0)}}},[t._v("批量主发送")]),t._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.batch(1)}}},[t._v("批量备发送")])],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"el_table",attrs:{data:t.tableData}},[t._v("\n        >\n        "),n("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:"切换源",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-radio-group",{model:{value:e.row.switchStatus,callback:function(n){t.$set(e.row,"switchStatus",n)},expression:"scope.row.switchStatus"}},[n("el-radio",{attrs:{label:0},on:{click:function(t){e.row.switchStatus=0}}},[t._v("主")]),t._v(" "),n("el-radio",{attrs:{label:1},on:{click:function(t){e.row.switchStatus=1}}},[t._v("备")])],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"success",size:"small"},on:{click:function(n){return t.changeData(e.row)}}},[t._v("编辑")]),t._v(" "),n("el-button",{attrs:{type:"success",size:"small"},on:{click:function(n){return t.sendData(e.row)}}},[t._v("发送")])]}}])})],1),t._v(" "),n("el-dialog",{attrs:{title:"编辑",visible:t.dialogVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-input",{staticClass:"el_input",attrs:{type:"textarea",rows:25},model:{value:t.editTable,callback:function(e){t.editTable=e},expression:"editTable"}}),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v("确 定")])],1)],1)],1)}),[],!1,null,"71053f6e",null);e.default=component.exports}}]);